<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>index (ppx_make.index)</title><link rel="stylesheet" href="../_odoc_support/odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc 2.2.0"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../_odoc_support/highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body class="odoc"><nav class="odoc-nav"><a href="../index.html">Up</a> â€“ ppx_make</nav><header class="odoc-preamble"><h1 id="[@@deriving-make]"><a href="#[@@deriving-make]" class="anchor"></a><code>[@@deriving make]</code></h1><p>Ppxlib based <code>[@@deriving]</code> plugin to generate make functions.</p></header><nav class="odoc-toc"><ul><li><a href="#usage">Usage</a></li><li><a href="#example">Example</a></li><li><a href="#syntax">Syntax</a><ul><li><a href="#supported-types">Supported Types</a><ul><li><a href="#records">Records</a></li><li><a href="#tuples">Tuples</a></li><li><a href="#options">Options</a></li><li><a href="#variants">Variants</a></li></ul></li><li><a href="#attributes">Attributes</a><ul><li><a href="#[@default]"><code>[@default]</code></a></li><li><a href="#[@required]"><code>[@required]</code></a></li><li><a href="#[@main]"><code>[@main]</code></a></li></ul></li></ul></li></ul></nav><div class="odoc-content"><h2 id="usage"><a href="#usage" class="anchor"></a>Usage</h2><p>To use <code>[@@deriving make]</code>, add <code>(preprocess (pps ppx_make))</code> to the library or executable configuration in dune file.</p><h2 id="example"><a href="#example" class="anchor"></a>Example</h2><pre class="language-ocaml"><code>type my_type = {
  my_field : int;
  my_option : int option;
  my_list : int list;
  my_string : string;
  my_default : int; [@default 1024]
}
[@@deriving make]

(* the deriver will automatically generate the following function *)
val make_my_type :
  my_field:int -&gt;
  ?my_option:int -&gt;
  ?my_list:int list -&gt;
  ?my_string:string -&gt;
  ?my_default:int -&gt;
  unit -&gt;
  my_type</code></pre><h2 id="syntax"><a href="#syntax" class="anchor"></a>Syntax</h2><p>When tagging <code>[@@deriving make]</code> to supported types, make functions will be derived accordingly.</p><h3 id="supported-types"><a href="#supported-types" class="anchor"></a>Supported Types</h3><h4 id="records"><a href="#records" class="anchor"></a>Records</h4><p>For a record type <code>t</code>, function <code>make_t</code> will be derived. By default, each field will be corresponded to a labeled argument, where the label is the same as the field name. If the field has type of <code>option</code>, <code>list</code>, <code>array</code> or <code>string</code>, the argument will be optional and have a default value of <code>None</code>, <code>[]</code>, <code>[||]</code> or <code>&quot;&quot;</code>. The function will finally take an <code>unit</code> and return the constructed <code>t</code>.</p><pre class="language-ocaml"><code>type t = {
  field : int;
  opt_field : int option;
  list_field : int list;
}
[@@deriving make]

val make_t : field:int -&gt; ?opt_field:int -&gt; ?list_field:int list -&gt; unit -&gt; t</code></pre><h4 id="tuples"><a href="#tuples" class="anchor"></a>Tuples</h4><p>For a tuple type <code>t</code>, function <code>make_t</code> will be derived. Each value in the tuple will be corresponded to a labeled argument. The first value will be corresponded to labeled argument <code>v0</code>, the second value to <code>v1</code> and vice versa. The optionality of the arguments follows the same rule as that of the record. The function will finally take an <code>unit</code> and return the constructed <code>t</code>.</p><pre class="language-ocaml"><code>type t = int * int option * int list [@@deriving make]

val make_t : v0:int -&gt; ?v1:int -&gt; ?v2:int list -&gt; unit -&gt; t</code></pre><h4 id="options"><a href="#options" class="anchor"></a>Options</h4><p>For an option type <code>t</code>, function <code>make_t</code> will be derived. The function will take an optional argument <code>?value</code> and an <code>unit</code>, and then return the constructed <code>t</code>.</p><pre class="language-ocaml"><code>type t = int option [@@deriving make]

val make_t : ?value:int -&gt; unit -&gt; t</code></pre><h4 id="variants"><a href="#variants" class="anchor"></a>Variants</h4><p>For a variant type <code>t</code>, a make function will be derived for each case of the variant. For a case <code>C</code> in variant <code>t</code>, function <code>make_c_of_t</code> will be derived. If the case is constant, the function will only take an <code>unit</code> and return the constant immediately. In other cases, the signature of the function will follow the rules described above. For case with only 1 argument, it will be considered as a tuple of size 1. Inline record is also supported.</p><pre class="language-ocaml"><code>type t =
  | Constant
  | Tuple of int * int option
  | Record of {
      field : int;
      opt_field : int option;
    }
[@@deriving make]

val make_constant_of_t : unit -&gt; t
val make_tuple_of_t : v0:int -&gt; ?v1:int -&gt; unit -&gt; t
val make_record_of_t : field:int -&gt; ?opt_field:int -&gt; unit -&gt; t</code></pre><h3 id="attributes"><a href="#attributes" class="anchor"></a>Attributes</h3><p>Attributes can be used to modify the behavior of the derived make function. Attributes may be prefixed with <code>make.</code> to avoid conflicts with other extensions.</p><h4 id="[@default]"><a href="#[@default]" class="anchor"></a><code>[@default]</code></h4><p>Set the default value of a field, and make the corresponding labeled argument optional.</p><pre class="language-ocaml"><code>type t = { field : int [@default 42] } [@@deriving make]

val make_t : ?field:int -&gt; unit -&gt; t</code></pre><h4 id="[@required]"><a href="#[@required]" class="anchor"></a><code>[@required]</code></h4><p>Make the corresponding argument of an optional field (i.e. <code>field: int option</code>) required.</p><pre class="language-ocaml"><code>type t = { field : int option [@required] } [@@deriving make]

val make_t : field:int option -&gt; unit -&gt; t</code></pre><h4 id="[@main]"><a href="#[@main]" class="anchor"></a><code>[@main]</code></h4><p>(Only apply to record) Convert a labeled argument into a positional argument. The make function will no longer require the <code>unit</code> at the end. Multiple fields can be tagged with this attribute within a single record. The order of the arguments will be the same as that of the fields.</p><pre class="language-ocaml"><code>type t = { field : int option [@main] } [@@deriving make]

val make_t : int option -&gt; t</code></pre></div></body></html>